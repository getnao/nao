{#
  Template: columns.md.j2
  Description: Generates column documentation for a database table

  Available context:
    - table_name (str): Name of the table
    - dataset (str): Schema/dataset name
    - db (DatabaseContext): Database context with helper methods
        - db.columns() -> list of dicts with: name, type, nullable, description
        - db.preview(limit=10) -> list of row dicts
        - db.row_count() -> int
        - db.column_count() -> int
        - db.partition_columns() -> list of partition/clustering column names
        - db.description() -> str or None
#}
{% set columns = db.columns() %}
{% set partitions = db.partition_columns() %}
# {{ table_name }}

**Dataset:** `{{ dataset }}`

{% if partitions %}
## Partition / Clustering columns

{% for col in partitions %}
- {{ col }}
{% endfor %}

> When querying this table, always filter on {% for col in partitions %}{{ col }}{% if not loop.last %}, {% endif %}{% endfor %} for best performance.

{% endif %}
## Columns ({{ columns | length }})

{% for col in columns %}
- {{ col.name }} ({{ col.type }}{% if col.description %}, "{{ col.description | truncate_middle(256) }}"{% endif %})
{% endfor %}
